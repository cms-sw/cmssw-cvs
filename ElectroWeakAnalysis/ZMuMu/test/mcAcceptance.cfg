process MCAcceptance = {
#  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  untracked PSet options = {
    untracked bool wantSummary = true  # default is false
  }
                                                  
  untracked PSet maxEvents = {
    untracked int32 input = -1
  }

  source = PoolSource {
    untracked vstring fileNames = {
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_1.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_2.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_3.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_4.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_6.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_7.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_8.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_9.root",
      "rfio:/dpm/na.infn.it/home/cms/store/user/degruttola/zToMuMuWithoutFilter/degrutto/Zmumu/zToMuMuWithoutFilter/49ffac29c1b9792022f4be1caf28e358/dimuons_10.root"
    }
  }

  module evtInfo = AsciiOutputModule {
  }

  service = TFileService { 
    string fileName ="mcAcceptanceStudy.root"
  }


  module zToMuMuMC = CandViewRefSelector {
    InputTag src = genParticles
    string cut = "pdgId = 23 & status = 3 & abs(daughter(0).pdgId) = 13"
  }	

# module dimuons = CandViewShallowCloneCombiner {
#   string decay = "selectedLayer1Muons@+ selectedLayer1Muons@-"
#   string cut = "mass > 0"
#   bool checkCharge = true
#   string name = "dimuon"
#   vstring roles = { 'muon1', 'muon2' }
# }
#
#  module goodMuonMCMatch = MCMatcher {
#    InputTag src = muons
#    InputTag matched = genParticles
#    double maxDeltaR = 0.15
#    double maxDPtRel = 1.0
#    bool resolveAmbiguities = false
#    bool resolveByMatchQuality = false
#    bool checkCharge = true
#    vint32 mcPdgId = { 13 } # muons
#    vint32 mcStatus = { 1 }
#  } 
#
#  module dimuonMCMatch = MCTruthCompositeMatcherNew {
#    InputTag src = dimuons
#    VInputTag matchMaps = { goodMuonMCMatch }
#    vint32 matchPDGId = { 23 }
#  }
#

  module dimuonMatches = DimuonMCMatcher {
    InputTag src = dimuons
  }

  module mcAcceptance = MCAcceptanceAnalyzer {
    InputTag zToMuMu = dimuons
    InputTag zToMuMuMC = zToMuMuMC	
    InputTag zToMuMuMatched = dimuonMatches	
    double ptMin = 20
    double etaMax = 2
    double massMin = 60
    double massMax = 120
  }	


  path mcPath = {
    zToMuMuMC,
#    dimuons, goodMuonMCMatch, dimuonMCMatch,
    dimuonMatches,
    mcAcceptance
  }

  endpath end = {
    evtInfo
  }

}

