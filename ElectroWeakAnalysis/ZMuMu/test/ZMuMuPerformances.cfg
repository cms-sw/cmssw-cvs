process ZMuMuPerformances = {

  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  include "ElectroWeakAnalysis/ZReco/data/mcTruthForDimuons.cff"
  include "ElectroWeakAnalysis/ZReco/data/dimuonsHLTFilter.cfi"

  source = PoolSource {
    untracked vstring fileNames = {
#	"file:skimmedZmm_test.root"
	"file:/tmp/piccolo/dimuons_3.root"  
	}
}

  untracked PSet maxEvents = {
    untracked int32 input = -1
  }

  service = TFileService { 
    string fileName ="zMuMuPerformances.root"
  }

 
  module zToMuMu = CandViewRefSelector {
    InputTag src = dimuons
    string cut = "daughter(0).isGlobalMuon = 1 & daughter(1).isGlobalMuon = 1"
#    using zSelection
#    bool filter = true
  }

  module zToMuMuOneTrack = CandViewRefSelector {
    InputTag src = dimuonsOneTrack
    string cut = "daughter(0).isGlobalMuon = 1"
  }

  module zToMuMuOneStandAloneMuon = CandViewRefSelector {
    InputTag src = dimuons
    string cut = "(daughter(0).isStandAloneMuon = 1 & daughter(0).isGlobalMuon = 0 & daughter(1).isGlobalMuon = 1) | (daughter(1).isStandAloneMuon = 1 & daughter(1).isGlobalMuon = 0 & daughter(0).isGlobalMuon = 1)"
  }

  module zMuMuPerformances = ZMuMuPerformances {
    InputTag muons = selectedLayer1Muons
    InputTag tracks = goodTracks		
    InputTag zMuMu = zToMuMu
    InputTag zMuTrack = zToMuMuOneTrack
    InputTag zMuStandAlone = zToMuMuOneStandAloneMuon
    InputTag muonIso = muonIsolations
    InputTag trackIso = muonIsolations
    InputTag goldenMuMap = allDimuonsMCMatch
    InputTag muonMatchMap = allDimuonsMCMatch
    InputTag zMuMuMatchMap = allDimuonsMCMatch
    InputTag zMuTrackMatchMap = allDimuonsMCMatch
    InputTag zMuStandAloneMatchMap = allDimuonsMCMatch
    InputTag genParticles = genParticles 
   
    bool MuonEfficiency = true
    bool TrackerEfficiency = true
    bool noCut =false

    untracked double isomax = 3
    untracked double ptminPlus = 20.0
    untracked double ptmaxPlus = 2000.0
    untracked double etaminPlus = -2.5
    untracked double etamaxPlus = 2.5
    untracked double ptminMinus = 20.0
    untracked double ptmaxMinus = 2000.0
    untracked double etaminMinus = -2.5
    untracked double etamaxMinus = 2.5
    untracked double zMassMin= 60.0
    untracked double zMassMax= 120.0
 }

   module eventInfo = AsciiOutputModule { 
#     untracked uint32 prescale = 1000
   }

   path p = {
	dimuonsHLTFilter,	
        mcTruthForDimuons,
	zToMuMu,
	zToMuMuOneStandAloneMuon,
	zToMuMuOneTrack,
	zMuMuPerformances}

   endpath e = { 
     eventInfo 
   }
}
